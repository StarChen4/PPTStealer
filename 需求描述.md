# 📄 微信文章提取 PPT 并生成 PDF 的 Web 应用开发需求文档

## 一、项目背景

需要开发一个 **Web 应用**，用户只需输入一个 **微信公众号文章链接**（如 `https://mp.weixin.qq.com/s/xxxx`），系统就能自动从该文章中提取 PPT 页面图片，并将这些内容按顺序生成 PDF 课件，供用户下载。

文章中通常包含文字、图片、视频、广告图片等。本工具只需要提取 **PPT 页面的图片**，其他无关内容需要排除（如二维码、广告图、尾页推广等）。

---

## 二、功能需求

### 1. 输入

用户在网页前端输入一个微信公众号文章链接，例如：

```
https://mp.weixin.qq.com/s/gRzseRcB8vg_lKqAsDVWTg
```

点击“生成 PDF”按钮。

---

### 2. 处理流程（后端执行）

后端需要完成以下任务：

---

### **步骤 1：抓取微信公众号文章 HTML 内容**

* 后端通过 HTTP GET 请求获取文章页面 HTML；
* 如有需要，需伪装浏览器 User-Agent；
* 若文章内容使用 `data-src` 的懒加载图片，需完整抓取。

---

### **步骤 2：从 HTML 中解析并提取所有图片 URL**

通常微信文章图片格式为：

```html
<img data-src="https://mmbiz.qpic.cn/xxxx" />
```

系统需提取所有 `img` 标签中的 `data-src` 或 `src` URL，并保持顺序。

---

### **步骤 3：筛选出只有 PPT 页面的图片**

筛选规则如下（要组合使用）：

#### ✔ 按 URL 区分

* PPT 图片通常来自 `mmbiz.qpic.cn` 域名；
* 一些广告、二维码可能来自不同 URL 或特别小。

#### ✔ 按分辨率过滤

下载图片后分析：

* PPT 页面一般分辨率高，例如 > 300k 像素；
* 宽高比接近 4:3 或 16:9（1.2~1.8）；
* 分辨率太低或比例奇怪的剔除。

#### ✔ 按出现位置过滤

* 微信文章首尾几张常为推广图，应自动排除；
* 通常 PPT 图片是一组连续的图，可自动识别连续段。

#### ✔ 可选：内容检测（如果实现成本允许）

* 检测是否含二维码；
* 检测是否包含大量广告文字。

目标：最终得到一组 PPT 页面图片的 URL 列表，顺序正确。

---

### **步骤 4：下载图片**

* 按顺序逐张下载筛选后的图片；
* 图片保存在临时目录，等待 PDF 生成。

---

### **步骤 5：生成 PDF**

将每张 PPT 图片作为 PDF 的一页，要求：

* 页码顺序与原文一致；
* 图片比例保持不变；
* PDF 文件可下载；
* 使用合适的 PDF 库（Python 或 Node 均可）。

---

### **步骤 6：将 PDF 返回给前端**

* 前端提供下载按钮；
* 或直接自动触发文件下载。

---

## 三、Web 前后端架构建议

### 前端

* 框架可选：Vue / React / Svelte
* 功能：

  * 输入文章链接
  * 点击生成
  * 显示加载提示
  * 最终提供 PDF 下载

### 后端

推荐使用 **Python + Flask/FastAPI**（PDF/图片处理库成熟）
或 Node.js（如需 JavaScript 全栈）。

必须具备：

* 获取文章内容
* HTML 解析
* 图片筛选算法
* PDF 生成

---

## 四、非功能性需求

* 错误处理友好，如：

  * 链接无效
  * 文章无法访问
  * 未找到有效 PPT 图片
* 处理速度应可接受（通常 2–10 秒）
* 临时文件需自动清理

---

## 五、界面风格

颜色 - 深色系，高对比度
风格 - 简约，活力

---

## 六、总结

需要根据本需求开发一个 **Web 应用**，实现从微信公众号文章链接中：

1. 获取文章
2. 提取图片
3. 筛选 PPT 图片
4. 生成 PDF
5. 返回给用户下载

